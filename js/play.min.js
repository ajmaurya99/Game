Product.Play=function(a){this._productGroup=null;this._spawnCornTimer=0;this._reset=false;Product._score=0;Product._fontStyle={font:"30px Luckiest Guy, cursive",fill:"#ed1c24",align:"left",smoothed:"true"};Product._fontStyleThick={font:"40px Luckiest Guy, cursive",fill:"#ed1c24",align:"left",smoothed:"true",strokeThickness:"8",stroke:"#000000"};Product._fontStyleCommentary={font:"30px Luckiest Guy, cursive",fill:"#ed1c24",align:"left",smoothed:"true",strokeThickness:"5",stroke:"#000000"};Product._fontStyleLogout={font:"20px Luckiest Guy, cursive",fontWeight:"normal",fill:"#ed1c24",align:"center",smoothed:"true"}};var player;var bgMusic=null;var collectMusic;var bombMusic;var products;var volumeOn;var volumeOff;var musicOff;var musicOn;var musicStatus=true;var statusChanged;var pauseClick=false;var isZoom;var _century=false;var _doubleCentury=false;var _tripleCentury=false;var _forthCentury=false;var _fifthCentury=false;var gameGesture;var clouds;var ret,fullScreenButton;Product.Play.prototype={preload:function(){},create:function(){clouds=game.add.tileSprite(0,0,640,600,"clouds");game.scale.fullScreenScaleMode=Phaser.ScaleManager.SHOW_ALL;Product._pausedOverlay=null;Product._gameOver=false;Product._scoreText=null;Product._score=0;Product._health=0;Product._velocity_speed=500;Product._deltaTime=0;Product._velocity=150;Product._velocityMax=700;Product._BhujiyaProduct=["alooBhujiya","periPeriBhujiya","barbequeBhujiya"];Product._PopcornProduct=["seaSaltAndPepperPopcorn","cheesePopcorn"];Product._JuiceProduct=["mixedFruitJuice","appleJuice"];Product._BiscuitProduct=["chocolateCream","digestive","marie"];Product._productType=Product._BhujiyaProduct.concat(Product._PopcornProduct,Product._JuiceProduct,Product._BiscuitProduct);Product._bombType=["bat","boll","bells"];Product._specialProductType=["glow1","glow2"];Product._audioType=["chak1","chak2","chak3","chak4"];Product._checkSpecialProduct=false;Product.specialProduct=false;Product._checkTimeForSpecial=0;Product._checkTimeForBomb=0;Product._specialTimer=0;Product._specialBombTimer=0;Product._firstLimit=150;Product._lastLimit=200;Product._SpecialTime=1;Product._SpecialTime2=3;Product._bgMusic=null;if(storage.isEmpty("bestScore")==true){storage.set("bestScore",0)}this.scale.refresh();this.time.advancedTiming=true;this.physics.startSystem(Phaser.Physics.ARCADE);this.physics.arcade.gravity.y=0;Product._pausedOverlay=this.add.sprite(0,0,"screenOverlay");Product._pausedOverlay.visible=false;var a=this.add.button(Product.GAME_WIDTH-600,Product.GAME_HEIGHT-60,"pauseButton",this.managePause,this);volumeOn=this.add.button(Product.GAME_WIDTH-530,Product.GAME_HEIGHT-60,"volumeOn",function(){this.manageMute(true)},this);this._spawnCornTimer=0;this.add.text(Product.GAME_WIDTH-180,Product.GAME_HEIGHT-60,"SCORE",Product._fontStyle);Product._scoreText=this.add.text(Product.GAME_WIDTH-85,Product.GAME_HEIGHT-60,"0",Product._fontStyle);Product._health=10;this._productGroup=this.add.group();this._productGroup.enableBody=true;this._productGroup.physicsBodyType=Phaser.Physics.ARCADE;player=this.add.sprite(0,Product.GAME_HEIGHT-300,"denture");player.anchor.setTo(0,0);game.physics.arcade.enable(player,Phaser.Physics.ARCADE);player.body.collideWorldBounds=true;player.animations.add("move",[1],10,true);player.frame=1;this.music(false);Product._bgMusic=game.add.audio("bgsound");Product._bgMusic.volume=0.7;Product._bgMusic.play();addBgImages();if(is_register==true){gameGesture=game.add.sprite(Product.GAME_WIDTH-400,Product.GAME_HEIGHT-550,"gesture");gameGesture.anchor.set(0.5,0.5);gameGesture.animations.add("zoom",[0,1,2],0.1,true);gameGesture.animations.play("zoom")}},managePause:function(){console.log("managePause click");console.log(pauseClick);if(pauseClick==false){custom_event("PauseButtonClick","Pause Button");pauseClick=true;this.game.paused=true;Product._pausedOverlay.visible=true;Product._pausedOverlay.bringToTop();var b=this.add.sprite(this.world.centerX,this.world.centerY-200,"pausedText");b.anchor.set(0.5,0.5);var c=this.add.sprite(this.world.centerX,this.world.centerY-100,"resumeButton");c.inputEnabled=true;c.anchor.set(0.5,0.5);if(!musicStatus==true){musicOff=this.add.button(this.world.centerX,this.world.centerY+20,"musicOff",function(){this.manageMusic(false)},this);musicOff.anchor.set(0.5,0.5)}else{musicOn=this.add.button(this.world.centerX,this.world.centerY+20,"musicOn",function(){this.manageMusic(true)},this);musicOn.anchor.set(0.5,0.5)}var a=this.add.button(this.world.centerX,this.world.centerY+130,"home",function(){custom_event("HomeButtonClick","Home Button");pauseClick=false;Product._pausedOverlay.visible=false;this.game.paused=false;game.state.start("menu",true,false)},this);a.anchor.set(0.5,0.5);c.events.onInputDown.add(function(){custom_event("ResumeButtonClick","Resume Button");pauseClick=false;b.destroy();c.destroy();a.destroy();if(musicStatus==true){musicOn.destroy()}else{musicOff.destroy()}Product._pausedOverlay.visible=false;this.game.paused=false;if(statusChanged==true){this.manageMute(!musicStatus)}},this)}},update:function(){if(is_register==true){Product._pausedOverlay.visible=true;player.visible=false;if(gameGesture.x==220){gameGesture.x+=2;ret=true}if((gameGesture.x+gameGesture.width)==701){gameGesture.x-=2;ret=false}if(ret==true){gameGesture.x+=2}else{gameGesture.x-=2}game.time.events.add(Phaser.Timer.SECOND*3,function(){Product._pausedOverlay.visible=false;gameGesture.destroy();player.visible=true;is_register=false},this)}else{if(this._reset){this._spawnCornTimer=0;Product._score=0;Product._scoreText.setText(Product._score);Product._deltaTime=0;Product._checkSpecialProduct=false;Product._checkTimeForSpecial=0;Product._checkTimeForBomb=0;Product._specialTimer=0;Product._specialBombTimer=0;Product.specialProduct=false;this._reset=false}if(Product._gameOver){updateScore()}this._spawnCornTimer+=this.time.elapsed;Product._specialTimer+=this.time.elapsed;Product._specialBombTimer+=this.time.elapsed;if(Product._checkTimeForSpecial===0){if(Product._checkSpecialProduct){Product._checkTimeForSpecial=getRandomInt(Product._SpecialTime,Product._SpecialTime2)*1000}else{Product._checkTimeForSpecial=getRandomInt(Product._SpecialTime,Product._SpecialTime2)*1000}}if(Product._checkTimeForBomb===0){Product._checkTimeForBomb=getRandomInt(3,5)*1000}var e=1500;if(Product._score>30){e=getRandomInt(500,1250)}else{if(Product._score>50){e=getRandomInt(500,800)}}if(this._spawnCornTimer>e&&Product._health){this._spawnCornTimer=0;Product.item.spawnCorn(this)}this._productGroup.forEachAlive(function(f){f.angle=f.rotateMe},this);game.physics.arcade.overlap(player,this._productGroup,collectPackets,null,this);player.body.velocity.x=0;if(!Product._health){var d=player.x;var c=player.y;player.scale.setTo(1,1);player.frame=0;this._productGroup.forEachAlive(function(f){f.body.velocity.y=0;f.body.allowGravity=false},this);var a=game.add.sprite(d,c,"out");var b=a.animations.add("zoom",[4,3,2,1,0],10,false);a.animations.play("zoom");game.time.events.add(Phaser.Timer.SECOND*1.5,function(){Product._gameOver=true;this.music(true)},this);document.getElementById("body").classList.remove("bganimate")}else{this.mouseAnimation()}clouds.tilePosition.x+=0.8}},mouseAnimation:function(){player.anchor.set(0,0);var a=160;if(game.input.y<game.height-100){player.x=game.input.x}if(isZoom==1){a=235}if(player.x<10){player.x=10}else{if(player.x>game.width-a){player.x=game.width-a}}},manageMute:function(a){if(pauseClick==false){if(a==true){volumeOn.destroy();volumeOff=this.add.button(Product.GAME_WIDTH-530,Product.GAME_HEIGHT-60,"volumeOff",function(){this.manageMute(false)},this);musicStatus=false}else{volumeOff.destroy();volumeOn=this.add.button(Product.GAME_WIDTH-530,Product.GAME_HEIGHT-60,"volumeOn",function(){this.manageMute(true)},this);musicStatus=true}this.toggleMute(a)}},manageMusic:function(a){if(a==true&&musicStatus==true){musicOff=this.add.button(this.world.centerX,this.world.centerY+20,"musicOff",function(){this.manageMusic(false)},this);musicStatus=false;musicOff.anchor.set(0.5,0.5);musicOn.destroy()}else{musicOn=this.add.button(this.world.centerX,this.world.centerY+20,"musicOn",function(){this.manageMusic(true)},this);musicStatus=true;musicOn.anchor.set(0.5,0.5);musicOff.destroy()}statusChanged=true},toggleMute:function(a){custom_event("MusicButtonClick","Music Button");if(a){game.sound.volume=0}else{game.sound.volume=0.7}},music:function(a){game.sound.mute=a}};Product.item={spawnCorn:function(e){var c=getRandomInt(70,Product.GAME_WIDTH-150);var b=-25;var d=0;products=null;if((Product._specialBombTimer>Product._checkTimeForBomb)&&!Product.specialProduct){d=getRandomInt(0,(Product._bombType.length-1));products=e.add.sprite(c,b,Product._bombType[d]);Product._checkTimeForBomb=0;Product._specialBombTimer=0}else{if((Product._specialTimer>Product._checkTimeForSpecial&&!Product._checkSpecialProduct&&Product._score>50)){d=getRandomInt(0,(Product._specialProductType.length-1));products=e.add.sprite(c,b,Product._specialProductType[d]);var a=products.animations.add("blink");products.animations.play("blink",30,true);updateSpecialProductData(true);Product._SpecialTime=15;Product._SpecialTime2=25}else{d=getRandomInt(0,(Product._productType.length-2));products=e.add.sprite(c,b,Product._productType[d])}}e.physics.enable(products,Phaser.Physics.ARCADE);products.anchor.setTo(0,0);products.cornType=d;products.inputEnabled=false;products.body.gravity.y=getRandomInt(Product._firstLimit,Product._lastLimit);Product._deltaTime=(e.time.elapsedMS*e.time.fps)/Product._velocity_speed;Product._velocity=Product._velocity+Product._deltaTime;products.body.velocity.y=(Product._velocity<Product._velocityMax)?Product._velocity:Product._velocityMax;products.checkWorldBounds=true;products.events.onOutOfBounds.add(this.removeCorn,this);products.rotateMe=getRandomInt(-45,45);e._productGroup.add(products);products.enableBody=true},removeCorn:function(b){if(Product._bombType.indexOf(b.key)!=-1||Product._specialProductType.indexOf(b.key)!=-1){Product._health=1;if(Product._specialProductType.indexOf(b.key)!=-1){updateSpecialProductData(false)}}else{removeMusic();Product._health=0;bombMusic=game.add.audio("explosion");bombMusic.play();var a=game.add.text(Product.GAME_WIDTH-450,Product.GAME_HEIGHT-400,"You missed a snack!",Product._fontStyleCommentary);game.time.events.add(Phaser.Timer.SECOND*2,function(){a.destroy()},this)}},killBomb:function(){Product._health=0},updateScore:function(a){Product._score+=(Product.specialProduct==true)?6:a;if((Product._score%30)==0){Product._firstLimit=Product._lastLimit;Product._lastLimit+=50}Product._scoreText.setText(Product._score);scoreCommentary()}};function scoreCommentary(){var a=Math.floor(Product._score/100);switch(a){case 1:if(!_century){showScoreCommentary("Chak Chak Century")}_century=true;break;case 2:if(!_doubleCentury){showScoreCommentary("Chak Chak Hitman")}_doubleCentury=true;break;case 3:if(!_tripleCentury){showScoreCommentary("Chak Chak Triple Ton")}_tripleCentury=true;break;case 4:if(!_forthCentury){showScoreCommentary("Chak Chak Lara")}_forthCentury=true;break;case 5:if(!_fifthCentury){showScoreCommentary("Chak Chak âœ‹")}_fifthCentury=true;break;default:}}function showScoreCommentary(b){var a=game.add.text(Product.GAME_WIDTH-480,Product.GAME_HEIGHT-800,b,Product._fontStyleThick);a.anchor.setTo(0,0);game.time.events.add(Phaser.Timer.SECOND*3,function(){a.destroy()},this)}function updateSpecialProductData(a){Product.specialProduct=a;Product._checkSpecialProduct=a;Product._checkTimeForSpecial=0;Product._specialTimer=0}function getRandomInt(b,a){return Math.floor(Math.random()*(a-b+1))+b}function collectPackets(g,f){var i;i=getRandomInt(0,(Product._audioType.length-1));var b=g.getBounds().x;var a=g.getBounds().x+g.width;var d=f.getBounds().x;var c=f.getBounds().x+f.width;if(((b<=d+10&&d<=a)||(b<=c+10&&c<=a))&&(f.getBounds().y>=(g.getBounds().y+5))){var e;if(Product._bombType.indexOf(f.key)!=-1){removeMusic();bombMusic=game.add.audio("explosion");bombMusic.play();Product.item.killBomb()}else{if(Product._productType.indexOf(f.key)!=-1){setScore(f);collectMusic=game.add.audio(Product._audioType[i]);collectMusic.play();e="normal"}else{if(Product._specialProductType.indexOf(f.key)!=-1){setSpecialScore(f);scalePlayer();collectMusic=game.add.audio(Product._audioType[i]);collectMusic.play();e="special";Product.specialProduct=true;Product._checkSpecialProduct=true;Product._checkTimeForSpecial=0}}}f.kill();g.animations.play("move");g.frame=0;var h="Chabaotastic!";if(e=="special"){h="Kya Chabaya!";commentary(f,h)}else{if(Product._score%200==0){h="Chabao Boost!";commentary(f,h)}else{if(Product._score%80==0){commentary(f,h)}}}}}function setScore(a){var b=0;if(Product._BhujiyaProduct.indexOf(a.key)!=-1){b=1}else{if(Product._PopcornProduct.indexOf(a.key)!=-1){b=2}else{if(Product._JuiceProduct.indexOf(a.key)!=-1){b=4}else{if(Product._BiscuitProduct.indexOf(a.key)!=-1){b=6}}}}Product.item.updateScore(b);displayScore(a,b)}function setSpecialScore(a){var b=0;if(Product._specialProductType.indexOf(a.key)==0){b=4}else{b=6}Product.item.updateScore(b);displayScore(a,b)}function scalePlayer(){player.anchor.setTo(0.5,0.5);game.add.tween(player.scale).to({x:1.5,y:1.5},1800,Phaser.Easing.Bounce.Out,true);isZoom=1;game.time.events.add(Phaser.Timer.SECOND*7,function(){game.add.tween(player.scale).to({x:1,y:1},1000,Phaser.Easing.Linear.easeInOut,true);isZoom=0;updateSpecialProductData(false)},this)}function commentary(c,d){var b=null;var a=(c.x>Product.GAME_WIDTH-250)?Product.GAME_WIDTH-250:c.x;b=game.add.text(a,Product.GAME_HEIGHT-340,d,Product._fontStyleCommentary);game.time.events.add(Phaser.Timer.SECOND*1,function(){b.destroy()},this)}function displayScore(b,c){var d=(Product.specialProduct==true)?6:c;var a=game.add.text(b.x,b.y,"+"+d,Product._fontStyle);game.physics.arcade.enable(a);a.body.gravity.y=100;a.anchor.set(-0.5,3);game.time.events.add(Phaser.Timer.SECOND*0.5,function(){a.kill()},this)}function updateScore(){if(typeof(Storage)!=="undefined"){if(Product._score>storage.get("bestScore")){storage.set("bestScore",Product._score)}}game.state.start("gameOver",true,false)}function addBgImages(){var a=document.getElementById("body");a.className+=" bganimate"}function removeMusic(){Product._bgMusic.destroy()};